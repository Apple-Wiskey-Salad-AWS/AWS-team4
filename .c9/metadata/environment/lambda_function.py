{"filter":false,"title":"lambda_function.py","tooltip":"/lambda_function.py","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["import json","import boto3","import moviepy.editor as mp","","s3 = boto3.client('s3')","sagemaker_runtime = boto3.client('runtime.sagemaker')","","def lambda_handler(event, context):","    s3_key = event['s3_key']","    bucket = 'your-s3-bucket'","","    video_obj = s3.get_object(Bucket=bucket, Key=s3_key)","    video_data = video_obj['Body'].read()","","    # 동영상 파일을 로컬에 저장","    with open('/tmp/video.mp4', 'wb') as f:","        f.write(video_data)","","    clip = mp.VideoFileClip('/tmp/video.mp4')","    frame = clip.get_frame(0)","    frame_path = '/tmp/frame.jpg'","    mp.ImageClip(frame).save_frame(frame_path)","","    with open(frame_path, 'rb') as f:","        frame_data = f.read()","","    response = sagemaker_runtime.invoke_endpoint(","        EndpointName='ep-xray-detection-4',","        ContentType='application/x-image',","        Body=frame_data","    )","    ","    result = response['Body'].read()","    ","    # 결과 반환","    return {","        'statusCode': 200,","        'body': json.dumps(result.decode('utf-8'))","    }",""],"id":1}],[{"start":{"row":9,"column":14},"end":{"row":9,"column":28},"action":"remove","lines":["your-s3-bucket"],"id":2},{"start":{"row":9,"column":14},"end":{"row":9,"column":22},"action":"insert","lines":["newdataa"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":12,"column":41},"end":{"row":12,"column":41},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1716467494060,"hash":"e3b23893ab5e109583ecb62e6c73bfe6abc27dbf"}